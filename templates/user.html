{% extends "layout.html" %}

{% block title %}
    User
{% endblock %}

{% block head %}

  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>

{% endblock %}

{% block script %}
  <script>

// Lifetime chart

var trace1 = {
  x: {{ x_values | safe }},
  y: {{ y_values | safe }},
  type: 'scatter'
};

var data = [trace1];

var layout = {
    title: "{{ username }}'s lifetime points",
    showlegend: false,
    paper_bgcolor: 'transparent',
    plot_bgcolor: 'transparent',
    font: {
      color: '#94a3b8',
      family: 'Nunito Sans'
    },
    xaxis: {
        gridcolor: '#64748b' 
    },
    yaxis: {
        gridcolor: '#64748b' 
    },
    modebar: {
      remove: ['select2d', 'lasso2d', 'autoScale2d'],
      orientation: 'v'
    },
    colorway: ['#3730a3'],
    margin: {
        l: 40, // left margin
        r: 40, // right margin
        b: 80, // bottom margin
        t: 80, // top margin
        pad: 0 // padding
    }
};

Plotly.newPlot('lifetime_chart', data, layout, {scrollZoom: true})


  // When the form is submitted, unhide the add to save button
  let params = new URLSearchParams(window.location.search);
  if (params.has('q')) {
      // Unhide the element
      document.querySelector('#add-to-save').classList.remove('hidden');
  } 

</script>
{% endblock %}

{% block main %}

<div class="flex flex-col divide-y-4 divide-slate-400/25 space-y-6 h-4/5">
  <div class="flex flex-col justify-center">
    <form action="/user">
      <input class="text-slate-300 bg-indigo-950 hover:bg-indigo-800 rounded-lg p-3 w-1/16 m-5 shadow-lg" type="text" id="q" name="q" placeholder="Username" value="{{ username }}">
        <input type="checkbox" id="save" name="save" class="" {{ save }}>
        <label for="save" class="mr-5 whitespace-nowrap">Save data?</label>
      <button class="bg-indigo-950 hover:bg-indigo-800 duration-100 rounded-md px-3 py-1" type="submit">Lookup</button>
    </form>
    <form class="hidden" id="add-to-save" action="/user" method="post">
      <button class="bg-indigo-950 hover:bg-indigo-800 duration-100 rounded-md px-3 py-1 m-4" type="submit" id="auto-save" name="auto-save" value="{{ username }}">Add user to auto save list?</button>
    </form>
  </div>
  <div class="justify-center flex flex-auto h-full" id="lifetime_chart"></div>
  <div class="justify-center w-full lg:h-96" id="daily-chart"></div>
</div>

{% endblock %}