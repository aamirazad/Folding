{% extends "layout.html" %}

{% block title %}
    User
{% endblock %}

{% block head %}

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0"></script>

{% endblock %}

{% block script %}
  <script>

  const ctx = document.getElementById('userChart');

  new Chart(ctx, {
    type: 'line',
    label: 'Points',

    data: {
      datasets: [{
        data: {{ database | safe }}
      }]
    },

    options: {
      plugins: {
        title: {
          text: "Total User's Points",
          display: true
        },
        legend: {
          display: false
        }
      },
      scales: {
        x: {
          text: "Date",
          type: 'time',
          title: {
            display: true,
            text: 'Date'
          },
          time: {
            displayFormats: {
              quarter: 'day'
            }
          },
        },
        y: {
          title: {
            display: true,
            text: 'Points'
          }
        }
      },
      parsing: {
        xAxisKey: 'date',
        yAxisKey: 'score'
      },

    }
  });

  </script>
{% endblock %}

{% block main %}
    <form action="/user">
        <input class="text-[#c4a7e7] bg-indigo-950 rounded-lg p-3 w-1/16 m-5" type="text" id="q" name="q" placeholder="Username" value="{{ username }}">
        <input type="checkbox" id="save" name="save" {{ save }}>
        <label for="save">Save data?</label>
        <button type="submit">Lookup</button>
    </form>
    <hr>
    <div class="relative h-350-px mx-32">
      <canvas id="userChart"></canvas>
    </div>
{% endblock %}